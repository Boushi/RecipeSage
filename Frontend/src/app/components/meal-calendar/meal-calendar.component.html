<div class="mealplan-flex">
  <div>
    <div class="calendar-nav">
      <ion-button
        class="previous"
        fill="clear"
        (click)="moveCalendar(-1)">
        <ion-icon name="caret-back" slot="icon-only"></ion-icon>
      </ion-button>
      <span>{{ calendarTitle() }}</span>
      <ion-button
        class="next"
        fill="clear"
        (click)="moveCalendar(1)">
        <ion-icon name="caret-forward" slot="icon-only"></ion-icon>
      </ion-button>
    </div>

    <ion-grid class="calendar" [ngClass]="{ full: mode === 'full', split: mode === 'split', outline: mode === 'outline' }">
      <ion-row class="week-title">
        <ion-col class="day-title" *ngFor="let day of dayTitles">
          {{day}}
        </ion-col>
      </ion-row>
      <ion-row class="week" *ngFor="let weekOfMonth of weeksOfMonth">
        <ion-col
          class="day"
          *ngFor="let day of weekOfMonth"
          (click)="selectedDay = day"
          (keyup.enter)="selectedDay = day"
          (mousedown)="dayMouseDown($event, day)"
          (mouseup)="dayMouseUp($event, day)"
          (dragover)="dayDragOver($event, day)"
          (drop)="dayDragDrop($event, day)"
          [ngClass]="{
              'selected': selectedDay && selectedDay.year() === day.year() && selectedDay.month() === day.month() && selectedDay.date() === day.date(),
              'today'   : today.getFullYear() === day.year() && today.getMonth() === day.month() && today.getDate() === day.date()
            }" tabindex="0">
          <div class="date" [ngClass]="{
            'selected': selectedDay && selectedDay.year() === day.year() && selectedDay.month() === day.month() && selectedDay.date() === day.date(),
            'inactive': center.getMonth() !== day.month(),
            'today'   : today.getFullYear() === day.year() && today.getMonth() === day.month() && today.getDate() === day.date()
          }">
            {{day.date()}}
          </div>
          <div *ngIf="mode === 'full'">
            <meal-group [mealItems]="mealItemsByDay(day)" [enableEditing]="enableEditing" (itemClicked)="itemClicked.emit($event)"></meal-group>
          </div>
          <div class="meal-marker-container" *ngIf="mode === 'split' || mode === 'outline'">
            <div class="meal-marker" *ngFor="let mealItem of mealItemsByDay(day).items"></div>
          </div>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>
  <ion-list *ngIf="mode === 'split'" class="meal-list" lines="none" class="ion-padding">
    <ion-item lines="none">
      <ion-label class="ion-text-center ion-no-padding">
        Meals For This Day:
      </ion-label>
    </ion-item>

    <ion-item *ngIf="mealItemsByDay(this.selectedDay).items.length === 0">
      <ion-label class="ion-text-wrap ion-text-center">
        <br />
        <p>
          There are no meals scheduled for this day.
        </p>
      </ion-label>
    </ion-item>

    <meal-group [mealItems]="mealItemsByDay(this.selectedDay)" [enableEditing]="enableEditing" (itemClicked)="itemClicked.emit($event)"></meal-group>
  </ion-list>
</div>

